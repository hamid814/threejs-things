!function(){"use strict";var e,n={5769:function(e,n,i){var t=i(2212);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function s(e,n){for(var i=0;i<n.length;i++){var t=n[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,(void 0,o=function(e,n){if("object"!==r(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var t=i.call(e,"string");if("object"!==r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t.key),"symbol"===r(o)?o:String(o)),t)}var o}function h(e,n,i){return n&&s(e.prototype,n),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}var a,c="x",d="y",u="z",l={corner:[0,2,4,6,8,9,10,11,12,14,16,18],cornerDirections:[{i:0,d:c},{i:2,d:u},{i:4,d:c},{i:6,d:u},{i:8,d:d},{i:9,d:d},{i:10,d:d},{i:11,d:d},{i:12,d:c},{i:14,d:u},{i:16,d:c},{i:18,d:u}],edgesDirections:{x:[{i:0,d:u},{i:2,d:c},{i:3,d:c},{i:5,d:c},{i:6,d:c},{i:7,d:d},{i:8,d:d},{i:9,d:u},{i:11,d:c},{i:12,d:c},{i:14,d:c},{i:15,d:c}],y:[{i:0,d:d},{i:1,d:d},{i:2,d:d},{i:3,d:d},{i:4,d:c},{i:6,d:u},{i:8,d:c},{i:10,d:u},{i:12,d:d},{i:13,d:d},{i:14,d:d},{i:15,d:d}],z:[{i:0,d:c},{i:1,d:u},{i:3,d:u},{i:4,d:u},{i:6,d:u},{i:7,d:d},{i:8,d:d},{i:9,d:c},{i:10,d:u},{i:12,d:u},{i:13,d:u},{i:15,d:u}]}},w=function(e,n,i){if("corner"===e)return l.cornerDirections.filter((function(e){return e.i===n}))[0].d;if("edge"===e){var t=l.edgesDirections[i].filter((function(e){return e.i===n}))[0];return t?t.d:t}},v=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new y(0,0,0),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;o(this,e),this.cubeMagnetude=i,this.level=n,this.cubeSize=1,this.position=t||new y(0,0,0),this.width=Math.pow(3,n),this.children=[],this.childSize=this.width/3,this.childrenType=null,this.mother=r,this.isEdge=void 0!==s&&s,this.direction=h,this.center=new y(this.width/2+.5,this.width/2+.5,this.width/2+.5),this.centerToPosition=this.position.retsub(this.center),this.centerNegate=new y(-this.center.x,-this.center.y,-this.center.z),this.facesCount=0,this.childrenType=1===n?"cube":"menger",this.initChildren()}return h(e,[{key:"isNeighbour",value:function(e){var n=Math.pow(3,this.level);function i(e,n){return(Math.ceil(e/(n/3))-1)%2==1}function t(e,n,t){return i(e,t)&&i(n,t)}return e.x>n||e.x<1||e.y>n||e.y<1||e.z>n||e.z<1?2:function n(i){return t(e.x,e.y,i)||t(e.y,e.z,i)||t(e.z,e.x,i)?1:3!==i?n(i/3):0}(n)}},{key:"initChildren",value:function(){var n=this;if(this.mother){var i=[],t=this.position.x+this.childSize,r=this.position.x-this.childSize,o=this.position.y+this.childSize,s=this.position.y-this.childSize,h=this.position.z+this.childSize,a=this.position.z-this.childSize,v=this.position.x,m=this.position.y,g=this.position.z;this.isEdge?this.direction===c?i=[new y(v,o,g),new y(v,o,a),new y(t,o,a),new y(t,o,h),new y(v,o,h),new y(r,o,h),new y(r,o,a),new y(v,m,a),new y(v,m,h),new y(v,s,g),new y(v,s,a),new y(t,s,a),new y(t,s,h),new y(v,s,h),new y(r,s,h),new y(r,s,a)]:this.direction===d?i=[new y(t,o,a),new y(t,o,h),new y(r,o,h),new y(r,o,a),new y(v,m,a),new y(t,m,a),new y(t,m,g),new y(t,m,h),new y(v,m,h),new y(r,m,h),new y(r,m,g),new y(r,m,a),new y(t,s,a),new y(t,s,h),new y(r,s,h),new y(r,s,a)]:this.direction===u&&(i=[new y(v,o,g),new y(t,o,a),new y(t,o,g),new y(t,o,h),new y(r,o,h),new y(r,o,g),new y(r,o,a),new y(t,m,g),new y(r,m,g),new y(v,s,g),new y(t,s,a),new y(t,s,g),new y(t,s,h),new y(r,s,h),new y(r,s,g),new y(r,s,a)]):(i[0]=new y(v,o,a),i[1]=new y(t,o,a),i[2]=new y(t,o,g),i[3]=new y(t,o,h),i[4]=new y(v,o,h),i[5]=new y(r,o,h),i[6]=new y(r,o,g),i[7]=new y(r,o,a),i[8]=new y(t,m,h),i[9]=new y(t,m,a),i[10]=new y(r,m,a),i[11]=new y(r,m,h),i[12]=new y(v,s,a),i[13]=new y(t,s,a),i[14]=new y(t,s,g),i[15]=new y(t,s,h),i[16]=new y(v,s,h),i[17]=new y(r,s,h),i[18]=new y(r,s,g),i[19]=new y(r,s,a)),this.isEdge?"cube"===this.childrenType?i.forEach((function(e){for(var i=[],t=0;t<p.length;t++){var r=p[t],o=r.position,s=new y(e.x,e.y,e.z);s.x+=o.x,s.y+=o.y,s.z+=o.z,n.mother.isNeighbour(s)&&i.push(r.id)}n.mother.addToFacesCount(i.length);var h=new f(e,n.childSize,i);n.children.push(h)})):"menger"===this.childrenType&&i.forEach((function(i,t){var r=!1,o=w("edge",t,n.direction);o&&(r=!0);var s=new e(n.level-1,n.cubeSize,i,n.mother,r,o);n.children.push(s)})):"cube"===this.childrenType?i.forEach((function(e){for(var i=[],t=0;t<p.length;t++){var r=p[t],o=r.position,s=new y(e.x,e.y,e.z);s.x+=o.x,s.y+=o.y,s.z+=o.z,n.mother.isNeighbour(s)&&i.push(r.id)}n.mother.addToFacesCount(i.length);var h=new f(e,n.childSize,i);n.children.push(h)})):"menger"===this.childrenType&&i.forEach((function(i,t){var r=!1,o=void 0;-1!==l.corner.indexOf(t)&&(o=w("corner",t),r=!0);var s=new e(n.level-1,n.cubeSize,i,n.mother,r,o);n.children.push(s)}))}else{var x=[],z=this.center.x+this.childSize,b=this.center.x-this.childSize,S=this.center.y+this.childSize,C=this.center.y-this.childSize,k=this.center.z+this.childSize,E=this.center.z-this.childSize,P=this.center.x,T=this.center.y,O=this.center.z;x[0]=new y(P,S,E),x[1]=new y(z,S,E),x[2]=new y(z,S,O),x[3]=new y(z,S,k),x[4]=new y(P,S,k),x[5]=new y(b,S,k),x[6]=new y(b,S,O),x[7]=new y(b,S,E),x[8]=new y(z,T,k),x[9]=new y(z,T,E),x[10]=new y(b,T,E),x[11]=new y(b,T,k),x[12]=new y(P,C,E),x[13]=new y(z,C,E),x[14]=new y(z,C,O),x[15]=new y(z,C,k),x[16]=new y(P,C,k),x[17]=new y(b,C,k),x[18]=new y(b,C,O),x[19]=new y(b,C,E),"cube"===this.childrenType?x.forEach((function(e,i){for(var t=[],r=0;r<p.length;r++){var o=p[r],s=o.position,h=new y(e.x,e.y,e.z);h.x+=s.x,h.y+=s.y,h.z+=s.z,n.isNeighbour(h)&&t.push(o.id)}n.addToFacesCount(t.length);var a=new f(e,n.childSize,t);n.children.push(a)})):"menger"===this.childrenType&&x.forEach((function(i,t){var r=!1,o=void 0;-1!==l.corner.indexOf(t)&&(o=w("corner",t),r=!0);var s=new e(n.level-1,n.cubeSize,i,n,r,o);n.children.push(s)}))}}},{key:"addToFacesCount",value:function(e){this.facesCount+=e}},{key:"getPositions",value:function(){var e=this,n=[];return"cube"===this.childrenType?(this.children.forEach((function(i){e.mother?e.mother.centerToPosition:e.centerToPosition;var t=i.position,r=e.mother?e.mother.cubeMagnetude:e.cubeMagnetude,o=e.mother?e.mother.position:e.position,s=e.mother?e.mother.centerNegate:e.centerNegate;t.x+=s.x,t.y+=s.y,t.z+=s.z,t.x*=r,t.y*=r,t.z*=r,t.x+=o.x,t.y+=o.y,t.z+=o.z,n.push({position:t,faces:i.faces})})),n):"menger"===this.childrenType?(this.children.forEach((function(e){e.getPositions().forEach((function(e){n.push(e)}))})),n):void 0}},{key:"drawP5",value:function(){this.children.forEach((function(e){e.drawP5()}))}}],[{key:"isCube",value:function(e,n){function i(e,n){return(Math.ceil(e/(n/3))-1)%2==1}function t(e,n,t){return i(e,t)&&i(n,t)}return e.x>n||e.x<1||e.y>n||e.y<1||e.z>n||e.z<1?2:function n(i){return t(e.x,e.y,i)||t(e.y,e.z,i)||t(e.z,e.x,i)?0:3!==i?n(i/3):1}(n)}}]),e}(),f=function(){function e(n,i,t){o(this,e),this.position=n,this.index=n,this.size=i,this.faces=t}return h(e,[{key:"drawP5",value:function(){push(),translate(this.position.x,this.position.y,this.position.z),box(this.size,this.size,this.size),pop()}}]),e}(),y=function(){function e(n,i,t){o(this,e),this.x=n,this.y=i,this.z=t}return h(e,[{key:"add",value:function(e){this.x+=e.x,this.y+=e.y,this.z+=e.z}},{key:"sub",value:function(e){this.x-=e.x,this.y-=e.y,this.z-=e.z}},{key:"mul",value:function(e){this.x*=e.x,this.y*=e.y,this.z*=e.z}},{key:"dev",value:function(e){this.x/=e.x,this.y/=e.y,this.z/=e.z}},{key:"retsub",value:function(n,i,t){var r=new e(this.x,this.y,this.z);if(void 0===i&&void 0===t)r.sub(n);else{var o=new e(n,i,t);r.sub(o)}return r}},{key:"retadd",value:function(n,i,t){var r=new e(this.x,this.y,this.z);if(void 0===i&&void 0===t)r.add(n);else{var o=new e(n,i,t);r.add(o)}return r}},{key:"retmul",value:function(n){var i=new e(this.x,this.y,this.z);return i.mul(n),i}},{key:"retdev",value:function(n){var i=new e(this.x,this.y,this.z);return i.dev(n),i}}]),e}(),p=[{position:new y(1,0,0),id:11},{position:new y(-1,0,0),id:10},{position:new y(0,1,0),id:21},{position:new y(0,-1,0),id:20},{position:new y(0,0,1),id:31},{position:new y(0,0,-1),id:30}],m=i(2886),g=i(5260),x=i(6426),z=i(5980),b=[0,2,1,2,3,1,4,6,5,6,7,5,8,10,9,10,11,9,12,14,13,14,15,13,16,18,17,18,19,17,20,22,21,22,23,21],S={11:[0,1,2,3,4,5],10:[6,7,8,9,10,11],21:[12,13,14,15,16,17],20:[18,19,20,21,22,23],31:[24,25,26,27,28,29],30:[30,31,32,33,34,35]},C=document.getElementById("webgl"),k=new t.WebGLRenderer({antialias:!0,canvas:C,preserveDrawingBuffer:!0});k.setSize(innerWidth,innerHeight),k.setPixelRatio(Math.min(2,devicePixelRatio)),document.body.appendChild(k.domElement);var E=new t.Scene,P=new t.OrthographicCamera(-10,10,8,-8,1,1e3);P.lookAt(0,0,0),P.position.set(0,30,30),E.add(P),new m.OrbitControls(P,k.domElement);var T=new t.PointLight(6710920,3);T.position.set(150,150,150),E.add(T);var O=new t.PointLight(8939110,3);O.position.set(-150,150,-150),E.add(O);var M=new t.PointLight(6719590,3);M.position.set(0,-150,0),E.add(M);var j=new t.BoxGeometry,U=new t.MeshNormalMaterial,D=new v(2,3,new y(0,0,0)),_=new g.xC(k),L=new x.C(E,P);_.addPass(L);var N=new z.T({uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\t\tuniform sampler2D tDiffuse;\n\t\tvarying vec2 vUv;\n\n    float map(float value, float min1, float max1, float min2, float max2) {\n      return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n    }\n    \n\t\tvoid main() {\n      vec2 doubleUv = vUv * 2.0;\n\n      if(vUv.x > 0.5) doubleUv.x = map(doubleUv.x - 1.0, 0.0, 1.0, 1.0, 0.0);\n      \n      if (vUv.y > 0.5) doubleUv.y = map(doubleUv.y - 1.0, 0.0, 1.0, 1.0, 0.0);\n\n\t\t\tvec4 vertex_Color = texture2D(tDiffuse, doubleUv);\n\n      // vertex_Color.r = map(vertex_Color.r, 0.0, 1.0, 0.3, 0.8);\n      \n      gl_FragColor = vec4(vertex_Color.r, vertex_Color.g, vertex_Color.b, 1.0);\n\t\t}"});_.addPass(N),function(e){var n=e.cubeMagnetude,i=e.getPositions();console.log("faces: ",e.facesCount),console.log("cubes count:",i.length);for(var r=new t.BufferGeometry,o=new Float32Array(2*e.facesCount*3*3),s=new Float32Array(2*e.facesCount*3*3),h=new t.BufferAttribute(o,3),c=new t.BufferAttribute(s,3),d=0,u=new t.Mesh(j,U),l=u.geometry.attributes.position,w=u.geometry.attributes.normal,v=0;v<i.length;v++)for(var f=i[v].position,y=i[v].faces,p=0;p<y.length;p++)for(var m=y[p],g=S[m],x=0;x<g.length;x++){var z=g[x];z=b[z];var C=l.array[3*z]*n+f.x,k=l.array[3*z+1]*n+f.y,P=l.array[3*z+2]*n+f.z,T=w.array[3*z],O=w.array[3*z+1],M=w.array[3*z+2];h.setXYZ(d,C,k,P),c.setXYZ(d,T,O,M),d++}r.setAttribute("position",h),r.setAttribute("normal",c),a=new t.Mesh(r,U),E.add(a)}(D),function e(){_.render(),a.rotation.y+=.005,requestAnimationFrame(e)}(),window.addEventListener("resize",(function(){return window.location.reload()})),window.addEventListener("resize",(function(){var e=innerWidth,n=innerHeight;k.setSize(e,n),P.aspect=e/n,P.updateProjectionMatrix()})),document.addEventListener("keydown",(function(e){"p"===e.key&&function(){try{var e="image/jpeg",n=k.domElement.toDataURL(e),i=document.getElementsByTagName("script"),t=i[i.length-1],r=new URL(t.src).pathname.slice(1,-3);F(n.replace(e,A),r+".jpg")}catch(e){return void console.log(e)}}()}));var A="image/octet-stream",F=function(e,n){var i=document.createElement("a");"string"==typeof i.download?(document.body.appendChild(i),i.download=n,i.href=e,i.click(),document.body.removeChild(i)):location.replace(uri)}}},i={};function t(e){var r=i[e];if(void 0!==r)return r.exports;var o=i[e]={exports:{}};return n[e](o,o.exports,t),o.exports}t.m=n,e=[],t.O=function(n,i,r,o){if(!i){var s=1/0;for(d=0;d<e.length;d++){i=e[d][0],r=e[d][1],o=e[d][2];for(var h=!0,a=0;a<i.length;a++)(!1&o||s>=o)&&Object.keys(t.O).every((function(e){return t.O[e](i[a])}))?i.splice(a--,1):(h=!1,o<s&&(s=o));if(h){e.splice(d--,1);var c=r();void 0!==c&&(n=c)}}return n}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[i,r,o]},t.d=function(e,n){for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e={5008:0};t.O.j=function(n){return 0===e[n]};var n=function(n,i){var r,o,s=i[0],h=i[1],a=i[2],c=0;if(s.some((function(n){return 0!==e[n]}))){for(r in h)t.o(h,r)&&(t.m[r]=h[r]);if(a)var d=a(t)}for(n&&n(i);c<s.length;c++)o=s[c],t.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return t.O(d)},i=self.webpackChunkthreejs_things=self.webpackChunkthreejs_things||[];i.forEach(n.bind(null,0)),i.push=n.bind(null,i.push.bind(i))}();var r=t.O(void 0,[2886,2452],(function(){return t(5769)}));r=t.O(r)}();